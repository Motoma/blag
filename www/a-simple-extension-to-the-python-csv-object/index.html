<!DOCTYPE html>
<html>

<head lang="en">
  
  <title>A Simple Extension to the Python CSV Object</title>

  <meta name="keywords"
	content="Motoma, csv, database, import, programming, python" />
  <meta name="description"
	content="One of the side effects of working with database driven software is that you eventually find yourself needing to pull in large amounts of information from old and terrible systems. When talking to your counterparts on the other side of the line (the inter-company line, that is), you will invariably be told that you will only receive your data in one of a few straight forward formats. What follows is a small extension to Python's CSV object which streamlines the process of coding these data transformations." />

  <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Blagmaster" />
  <meta name="google-site-verification"
        content="fpiMFEd5SHR15hcV7NKYxnCoqx3zGOOC-iqaJdArezw" />

  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/static/layout.css" />

  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

<body>
  <header>
    <h1><a href="/">
      <img src="/static/motoma.io.32.inverted.eps.png" alt="Motoma.io" />
    </a></h1>
  </header>

  <nav>
    
    <ul>
      <li class="link">
        <a href="/about/" title="Learn more about me" class="link">About</a>
      </li>
        
      <li class="current">
        <a href="/" title="Goto the blog" class="current">Blog</a>
      </li>
    </ul>
    

    <section>
      <a href="http://www.linkedin.com/in/motoma">
	<img src="/static/linkedin.png" /></a>
      <a href="http://www.facebook.com/motoma">
	<img src="/static/facebook.png" /></a>
      <a href="http://www.twitter.com/motoma">
	<img src="/static/twitter.png" /></a>
      <a href="https://plus.google.com/106366683920288141812?rel=author">
	<img src="/static/gplus.png" /></a>
      <a href="http://www.github.com/motoma">
	<img src="/static/github.png" /></a>
    </section>
  </nav>

  <section class="content">
    
    <article class="hentry">
      <h3>
	<a href="/a-simple-extension-to-the-python-csv-object/" class="entry-title">A Simple Extension to the Python CSV Object</a>
      </h3>
      <p class="byline author vcard instapaper_ignore entry-unrelated">
        <time class="published updated" datetime="2008-06-22">
          2008-06-22</time> by
        <a href="https://plus.google.com/106366683920288141812?rel=author"
           rel="author" class="fn" lang="en">Motoma</a>, tagged as
        
        <a href="/tags/csv">csv</a>
        
        <a href="/tags/database">database</a>
        
        <a href="/tags/import">import</a>
        
        <a href="/tags/programming">programming</a>
        
        <a href="/tags/python">python</a>
        
        
      </p>
      
<p>One of the side effects of working with database driven software is that you eventually find yourself needing to pull in <a title="Petabyte" href="http://en.wikipedia.org/wiki/Petabyte">large amounts of information</a> from <a title="AS/400" href="http://en.wikipedia.org/wiki/AS/400">old</a> and <a title="Flat file database" href="http://en.wikipedia.org/wiki/Flat_file_database">terrible</a> systems. When talking to your counterparts on the other side of the line (the inter-company line, that is), you will invariably be told that you will only receive your data in one of a few <a title="CSV" href="http://en.wikipedia.org/wiki/Comma-separated_values">straight</a> <a title="Vertical bar" href="http://en.wikipedia.org/wiki/Vertical_bar">forward</a> <a title="Fixed width" href="http://en.wikipedia.org/wiki/Fixed_width">formats</a>. What follows is a small extension to Python's CSV object which streamlines the process of coding these data transformations.</p>

<!-- break -->

<p>Simply put, Python's CSV object is more than enough to handle any conversion; however, in order to make my life <span style="text-decoration: underline;">even simpler</span>, I made the following wrapper:</p>
<script src="https://gist.github.com/589834.js?file=python-csvfilehandler.py"></script>

<p>Here, the process accepts a function object, and an argument (tuple most likely). The CSVFileHandler object will execute the function on each line of the file, making the main loop of your processing code a meek 3 lines long. Take, for example, the following code:</p>
<script src="https://gist.github.com/589837.js?file=python-csv-import.py"></script>

<p>The code listing above quickly parses through that old CSV file and leaves with with a shiney new SQL data file to load into your database.</p>


      <div id="disqus_thread"></div>
      <script type="text/javascript">
	var disqus_shortname = 'motomastyle';
	var disqus_identifier = '/a-simple-extension-to-the-python-csv-object';
	var disqus_url = 'http://motoma.io//a-simple-extension-to-the-python-csv-object';
	
	(function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || 
          document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
      </script>
      <noscript>
	Please enable JavaScript to view the 
	<a href="http://disqus.com/?ref_noscript">
	  comments powered by Disqus.</a>
      </noscript>
      <a href="http://disqus.com" class="dsq-brlink">
	blog comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>

  </section>

  <aside>
    <section class="projects">
      <ul>
	
	<li class="odd">
	  <a href="https://www.github.com/Motoma/bitgirl">BitGirl</a>
	  <p>BitGirl is a fully pluggable Python-based IRC bot which allows dynamic command and module loading, unloading, and reloading on the fly.</p>
	</li>
	
	<li class="even">
	  <a href="https://code.google.com/p/socksipy-branch/">socksipy-branch</a>
	  <p>A Python SOCKS client module This module was designed to allow developers of Python software that uses the Internet or another TCP/IP-based.</p>
	</li>
	
	<li class="odd">
	  <a href="http://sourceforge.net/projects/pyloris/">PyLoris</a>
	  <p>PyLoris is a scriptable tool for testing a server's vulnerability to connection exhaustion denial of service (DoS) attacks.</p>
	</li>
	
      </ul>
    </section>

    <section class="random">
      <h4>/dev/urandom</h4>
      <p>"There is no greater importance in all the world like knowing you are
	right and that the wave of the world is wrong, yet the wave crashes 
	upon you."</p>
    </section>

    <section class="links">
      <h4>Blogs I Follow</h4>
      <ul>
        <li><a href="http://www.eflorenzano.com/">Die in a Fire</a></li>
        <li><a href="http://www.lostgarden.com">Lost Garden</a></li>
        <li><a href="http://parsedcontent.blogspot.com">
	    { Parsed Content }</a></li>
        <li><a href="http://www.particlesinmotion.com">
	    Particles in Motion</a></li>
        <li><a href="http://www.schneier.com">Schneier on Security</a></li>
        <li><a href="http://teddziuba.com/">Ted Dziuba</a></li>
        <li><a href="http://rdist.root.org">root labs rdist</a></li>
        <li><a href="http://www.veracode.com/blog">
	    Veracode Security Blog</a></li>
      </ul>
    </section>

    <section class="links">
      <h4>Web Comics</h4>
      <ul>
        <li><a href="http://www.dresdencodak.com/">Dresden Codak</a></li>
        <li><a href="http://www.xkcd.com/">XKCD</a></li>
      </ul>
    </section>
  </aside>

  <footer>
    <p>motoma.io and all content therein is copyright of Christopher Gilbert 
      — © 2012 All rights reserved.</p>
  </footer>

  <script src="http://www.google-analytics.com/ga.js" type="text/javascript"></script>
  <script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-1667338-1");
    pageTracker._initData();
    pageTracker._trackPageview();
  </script>
  <!-- Piwik -->
  <script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.completelyreliable.com/" : "http://stats.completelyreliable.com/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 4);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
  </script><noscript><p><img src="http://stats.completelyreliable.com/piwik.php?idsite=4" style="border:0" alt="" /></p></noscript>
  <!-- End Piwik Tracking Code -->
</body>
</html>